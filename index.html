<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GDIS Solar - Proposta</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap">
  <style>
    /* ---------------------- */
    /* Cores e Variáveis      */
    /* ---------------------- */
    :root {
      /* Tema padrão: Alta Performance */
      --main-blue: #123d8c;
      --dark-blue: #0a2a5c;
      --highlight-color: #ff7a29;
      --secondary-highlight: #ff7a29;
      --white: #ffffff;
      --light-gray: #f4f6fb;
      --muted-text: #6f7d95;
      --nav-bg: rgba(18, 61, 140, 0.9);
      --gradient-bg: linear-gradient(135deg, var(--main-blue) 0%, var(--dark-blue) 50%, #174296 100%);
      --radius: 22px;
      --shadow: 0 8px 20px rgba(0, 0, 0, .15);
    }

    body.economic-theme {
      /* NOVO TEMA: Econômico */
      --main-blue: #598c76;
      --dark-blue: #315e4a;
      --highlight-color: #79c9a0;
      --secondary-highlight: #598c76;
      --white: #ffffff;
      --light-gray: #f7faf7;
      --muted-text: #6f7d95;
      --nav-bg: rgba(89, 140, 118, 0.9);
      --gradient-bg: linear-gradient(135deg, var(--main-blue) 0%, var(--dark-blue) 50%, #4c6f5d 100%);
    }

    /* ---------------------- */
    /* Estilos Gerais         */
    /* ---------------------- */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', sans-serif;
      line-height: 1.6;
      transition: background-color 0.5s ease;
      color: var(--dark-blue);
      background: var(--light-gray);
    }

    /* Esconde as seções de proposta por padrão */
    .proposal-container {
        display: none;
        background: var(--light-gray);
        color: var(--dark-blue);
    }

    /* Estilos para o container do formulário */
    .form-container {
        background: var(--gradient-bg);
        color: var(--white);
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        flex-direction: column;
        transition: background 0.5s ease;
    }

    .form-box {
      width: 100%;
      max-width: 500px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      padding: 40px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      text-align: center;
    }

    .form-box .logo img {
      height: 80px;
      margin-bottom: 20px;
    }

    .form-box h1 {
      font-size: clamp(28px, 5vw, 40px);
      font-weight: 800;
      margin-bottom: 10px;
    }

    .form-box p {
      font-size: 16px;
      margin-bottom: 30px;
      opacity: 0.8;
    }

    .search-form {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .search-form input[type="text"] {
      width: 100%;
      padding: 15px 20px;
      border-radius: 50px;
      border: none;
      font-size: 16px;
      background: rgba(255, 255, 255, 0.2);
      color: var(--white);
      transition: background 0.3s ease;
    }

    .search-form input[type="text"]::placeholder {
      color: rgba(255, 255, 255, 0.7);
    }

    .search-form input[type="text"]:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.3);
    }

    .search-form button {
      width: 100%;
      padding: 15px 20px;
      border-radius: 50px;
      border: none;
      font-size: 18px;
      font-weight: 700;
      cursor: pointer;
      background: var(--highlight-color);
      color: var(--white);
      transition: background 0.3s ease, transform 0.1s;
    }

    .search-form button:hover {
      background: var(--secondary-highlight);
    }

    .search-form button:active {
      transform: translateY(1px);
    }
    
    .message-box {
        margin-top: 20px;
        padding: 15px;
        background: rgba(255, 0, 0, 0.2);
        border-radius: 8px;
        display: none;
        font-size: 14px;
        font-weight: 500;
        border: 1px solid rgba(255, 0, 0, 0.4);
    }

    /* ---------------------- */
    /* Componentes da Proposta*/
    /* ---------------------- */
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .clean-section {
      background: var(--white);
      margin: 40px 0;
      padding: 60px 20px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      transition: background-color 0.5s ease;
    }

    section {
      position: relative;
      overflow: hidden;
    }

    .payback-section-bg {
      background: var(--dark-blue);
      color: var(--white);
      margin: 40px 0;
      padding: 60px 20px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      transition: background-color 0.5s ease;
    }

    .payback-section-bg h2 {
      color: var(--white);
    }

    section h2 {
      text-align: center;
      font-size: clamp(28px, 4vw, 40px);
      margin-bottom: 12px;
      color: var(--dark-blue);
      font-weight: 700;
      transition: color 0.5s ease;
    }

    section p.lead {
      text-align: center;
      color: var(--muted-text);
      margin-bottom: 40px;
      font-size: 18px;
      transition: color 0.5s ease;
    }

    .grid {
      display: grid;
      gap: 30px;
    }

    .grid-2 {
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    }

    .grid-3 {
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    }

    .card {
      background: var(--white);
      border-radius: var(--radius);
      padding: 30px;
      box-shadow: var(--shadow);
      transition: all .3s ease, background-color 0.5s ease;
    }

    .card:hover {
      transform: translateY(-5px);
    }

    .text-center {
      text-align: center;
    }

    .nav-bar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: var(--nav-bg);
      padding: 20px 30px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      transition: background 0.5s ease;
    }

    .nav-bar .logo {
      display: flex;
      align-items: center;
    }

    .nav-bar img {
      height: 60px;
    }

    .nav-middle-content {
      display: flex;
      flex: 1;
      justify-content: center;
      align-items: center;
      gap: 20px;
    }

    .header-prices-info {
      max-width: 0;
      opacity: 0;
      overflow: hidden;
      display: flex;
      align-items: center;
      gap: 20px;
      transition: max-width 0.6s ease, opacity 0.6s ease;
      flex-shrink: 0;
    }

    .nav-bar.show-prices .header-prices-info {
      max-width: 500px;
      opacity: 1;
    }

    .header-price-item {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .header-price-item small {
      color: #d1d9e2;
      font-size: 11px;
      font-weight: 500;
      text-transform: uppercase;
      margin-bottom: 2px;
    }

    .header-price-item p {
      color: var(--white);
      font-size: 16px;
      font-weight: 700;
      line-height: 1;
      margin: 0;
    }

    .header-price-item .min-parcel-label {
      text-align: center;
    }

    .header-price-item .max-installments {
      color: var(--highlight-color);
      font-size: 11px;
      font-weight: 600;
      margin-top: 2px;
      transition: color 0.5s ease;
    }

    @media (min-width: 1024px) {
        .nav-bar .logo {
            flex-shrink: 0;
        }
        .nav-bar .proposal-options {
            flex-grow: 1;
            justify-content: flex-end;
        }
        .nav-middle-content {
          flex: 1 1 auto;
          gap: 40px;
        }
        .nav-bar .header-prices-info {
          justify-content: flex-start;
        }
    }

    @media (max-width: 1023px) {
        .header-prices-info {
          display: none;
        }
    }

    header.hero {
      background: var(--gradient-bg);
      color: var(--white);
      padding: 120px 20px 100px;
      position: relative;
      overflow: hidden;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: background 0.5s ease;
    }

    header.hero .title-and-subtitle {
      margin-top: 100px;
    }

    header.hero h1 {
      font-size: clamp(38px, 6vw, 68px);
      font-weight: 800;
      margin-bottom: 10px;
      line-height: 1.1;
    }

    .proposal-details {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(5px);
      border-radius: 12px;
      padding: 20px;
      margin-top: 20px;
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
      justify-content: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .proposal-details .item {
      text-align: center;
      flex: 1 1 150px;
    }

    .proposal-details .item h3 {
      font-size: 14px;
      color: #b3c2e1;
      font-weight: 500;
      margin-bottom: 4px;
    }

    .proposal-details .item p {
      font-size: 16px;
      font-weight: 600;
      color: var(--white);
      margin: 0;
      word-break: break-word;
    }

    .proposal-options {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      width: 100%;
    }

    .proposal-options .option {
      background: rgba(233, 236, 239, 0.2);
      border: 2px solid transparent;
      border-radius: 50px;
      padding: 12px 24px;
      cursor: pointer;
      transition: all .3s ease;
      font-weight: 600;
      font-size: 14px;
      color: #d1d9e2;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .proposal-options .option.selected {
      color: var(--white);
      border: 2px solid var(--white);
      box-shadow: 0 4px 10px rgba(0,0,0,.2);
    }

    .option.selected.high-performance-active {
        background: var(--highlight-color);
    }

    .option.selected.economic-active {
        background: var(--highlight-color);
    }

    .proposal-options .option input {
      display: none;
    }

    .info-card {
      text-align: center;
      padding: 40px 20px;
    }

    .info-card svg {
      width: 48px;
      height: 48px;
      margin-bottom: 12px;
      color: var(--highlight-color);
      transition: color 0.5s ease;
    }

    .info-card h3 {
      font-size: 18px;
      font-weight: 600;
      color: var(--dark-blue);
      margin-bottom: 5px;
      transition: color 0.5s ease;
    }

    .info-card .value {
      font-size: 32px;
      font-weight: 800;
      color: var(--highlight-color);
      margin: 0;
      line-height: 1.2;
      transition: color 0.5s ease;
    }

    .info-card-icon {
      display: block;
      width: 48px;
      height: 48px;
      margin: 0 auto 12px;
      color: var(--highlight-color);
      transition: color 0.5s ease;
    }

    .payback-section-bg {
      background: var(--dark-blue);
      color: var(--white);
      margin: 40px 0;
      padding: 60px 20px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      transition: background-color 0.5s ease;
    }

    .payback-content-container {
      max-width: 800px;
      margin: 0 auto;
      padding: 40px;
      border-radius: var(--radius);
      background: var(--white);
      box-shadow: var(--shadow);
      text-align: center;
      transition: background-color 0.5s ease;
    }

    .payback-details {
      font-size: 16px;
      color: var(--muted-text);
      max-width: 600px;
      margin: 0 auto;
      transition: color 0.5s ease;
    }

    .payback-details strong {
      color: var(--highlight-color);
      transition: color 0.5s ease;
    }

    .payback-highlight-box {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    .payback-highlight-box svg {
      width: 50px;
      height: 50px;
      color: var(--highlight-color);
      transition: color 0.5s ease;
    }

    .payback-highlight-box p {
      font-size: clamp(20px, 4vw, 28px);
      font-weight: 600;
      color: var(--dark-blue);
      transition: color 0.5s ease;
    }

    .payback-highlight-box p strong {
      font-size: clamp(24px, 5vw, 36px);
      font-weight: 900;
      color: var(--highlight-color);
      display: block;
      margin-top: 5px;
      transition: color 0.5s ease;
    }

    .prod-grid {
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
    }

    .prod-card h3 {
      font-size: 22px;
      margin-bottom: 8px;
    }

    .prod-table {
      margin-top: 15px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      background: var(--light-gray);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: inset 0 0 5px rgba(0, 0, 0, .05);
      transition: background-color 0.5s ease;
    }

    .prod-table div {
      padding: 15px;
      border-bottom: 1px solid #ddd;
      font-size: 15px;
    }

    .prod-table div:nth-child(2n) {
      border-left: 1px solid #ddd;
      font-weight: 600;
      color: var(--dark-blue);
    }
    
    .prod-table div:last-child,
    .prod-table div:nth-last-child(2) {
      border-bottom: none;
    }

    .prod-image {
      max-width: 100%;
      height: auto;
      border-radius: 12px;
      margin-bottom: 15px;
    }
    
    /* ---------------------- */
    /* Rodapé                 */
    /* ---------------------- */
    .contact-footer {
        background: var(--dark-blue);
        color: var(--muted-text);
        padding: 40px 20px;
        text-align: center;
        transition: background-color 0.5s ease;
    }
    .contact-footer .contact-info {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        gap: 20px;
    }
    .contact-footer .contact-link {
        color: var(--white);
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
        transition: color 0.3s ease;
    }
    .contact-footer .contact-link svg {
        width: 20px;
        height: 20px;
    }
    .contact-footer .contact-link:hover {
        color: var(--highlight-color);
    }
    .contact-footer small {
        display: block;
        margin-top: 20px;
        font-size: 12px;
    }
  </style>

</head>
<body>

  <!-- Container de Formulário de Consulta -->
  <div id="formContainer" class="form-container">
    <div class="form-box">
      <div class="logo">
        <!-- Usando a logo.png -->
        <img src="logo.png" alt="GDIS Logo">
      </div>
      <h1>Proposta Comercial</h1>
      <p>Digite o número do projeto para visualizar sua proposta.</p>
      <form id="searchForm" class="search-form">
        <input type="text" id="projectIdInput" placeholder="Número do Projeto" required>
        <button type="submit">Consultar</button>
      </form>
      <div id="messageBox" class="message-box"></div>
    </div>
  </div>

  <!-- Container da Proposta (inicialmente invisível) -->
  <div id="proposalContainer" class="proposal-container">
    <!-- Barra de Navegação Fixa -->
    <nav class="nav-bar">
      <div class="logo">
        <img src="logo.png" alt="GDIS Logo">
      </div>
      <div class="nav-middle-content">
        <div class="header-prices-info">
          <div class="header-price-item">
            <small>Valor à vista</small>
            <p id="navBarAvistaPrice">R$ 0,00</p>
          </div>
          <div class="header-price-item">
            <small class="min-parcel-label">Parcela mínima</small>
            <p id="navBarMinParcel">R$ 0,00</p>
            <span class="max-installments">60x sem juros</span>
          </div>
        </div>
      </div>
    </nav>
  
    <!-- Cabeçalho Principal -->
    <header class="hero">
      <div class="title-and-subtitle">
        <h1>Proposta Personalizada</h1>
        <p class="lead" id="clientName">Aguardando dados do cliente...</p>
      </div>
      <div class="proposal-details">
        <div class="item">
          <h3>NÚMERO DA PROPOSTA</h3>
          <p id="proposalNumber">#0000</p>
        </div>
        <div class="item">
          <h3>POTÊNCIA DO SISTEMA</h3>
          <p id="systemPower">0,00 kWp</p>
        </div>
        <div class="item">
          <h3>GERAÇÃO MENSAL</h3>
          <p id="monthlyGeneration">0,00 kWh</p>
        </div>
        <div class="item">
          <h3>ECONOMIA MENSAL</h3>
          <p id="monthlySavings">R$ 0,00</p>
        </div>
      </div>
    </header>
  
    <!-- Seção de Vantagens da Energia Solar -->
    <section class="container clean-section">
      <h2>Energia Solar é um excelente investimento.</h2>
      <p class="lead">Entenda os principais benefícios que a energia solar traz para você.</p>
      <div class="grid grid-3">
        <div class="card info-card text-center">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="info-card-icon">
            <path d="M22 10.5V12a10 10 0 1 1-5.98-9.06"/>
            <path d="M22 6L16.29 11.71A2 2 0 0 1 14.88 12.3L13 14"/>
            <path d="M15 13.5L13.5 15"/>
            <path d="M16 11L14 13"/>
            <path d="M12.5 16.5L10.5 18"/>
            <path d="M13 14L9 18"/>
            <path d="M17 11L15 13"/>
            <path d="M18 9L16 11"/>
            <path d="M22 2L18 6"/>
          </svg>
          <h3>Valorização do Imóvel</h3>
          <p class="value" id="propertyValueIncrease">Até 30%</p>
          <p>O seu imóvel valoriza imediatamente após a instalação do sistema fotovoltaico.</p>
        </div>
        <div class="card info-card text-center">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="info-card-icon">
            <path d="M12 2L8.2 8.2l-6.2 1.4L6.9 14l-.9 6.1 6-2.5 6 2.5-.9-6.1 4.9-4.4-6.2-1.4L12 2z"/>
          </svg>
          <h3>Proteção Financeira</h3>
          <p class="value" id="financialProtection">99%</p>
          <p>Se proteja contra os aumentos na conta de luz e economize dinheiro.</p>
        </div>
        <div class="card info-card text-center">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="info-card-icon">
            <path d="M4 14.89a2.54 2.54 0 0 1-1.39-4.24l.15-.17a3 3 0 0 1 3.51-3.61l.55.15a.5.5 0 0 0 .58-.33l.48-1.5a3 3 0 0 1 3.56-2.18l.82.16a.5.5 0 0 0 .5-.29l.39-1.39a3 3 0 0 1 3.12-1.89l.34.1a.5.5 0 0 0 .42-.23l.23-.39a3 3 0 0 1 2.89-1.53l.63.15a.5.5 0 0 0 .51-.26l.48-1.5a3 3 0 0 1 3.56-2.18l.82.16a.5.5 0 0 0 .5-.29l.39-1.39a3 3 0 0 1 3.12-1.89l.34.1a.5.5 0 0 0 .42-.23l.23-.39a3 3 0 0 1 2.89-1.53"/>
            <path d="M4 14.89a2.54 2.54 0 0 1-1.39-4.24l.15-.17a3 3 0 0 1 3.51-3.61l.55.15a.5.5 0 0 0 .58-.33l.48-1.5a3 3 0 0 1 3.56-2.18l.82.16a.5.5 0 0 0 .5-.29l.39-1.39a3 3 0 0 1 3.12-1.89l.34.1a.5.5 0 0 0 .42-.23l.23-.39a3 3 0 0 1 2.89-1.53"/>
            <path d="M4 14.89a2.54 2.54 0 0 1-1.39-4.24l.15-.17a3 3 0 0 1 3.51-3.61l.55.15a.5.5 0 0 0 .58-.33l.48-1.5a3 3 0 0 1 3.56-2.18l.82.16a.5.5 0 0 0 .5-.29l.39-1.39a3 3 0 0 1 3.12-1.89l.34.1a.5.5 0 0 0 .42-.23l.23-.39a3 3 0 0 1 2.89-1.53"/>
            <path d="M12 21a9.5 9.5 0 1 1-9.5-9.5A9.5 9.5 0 0 1 12 21Z" />
            <path d="M14.5 12.5a2.5 2.5 0 0 1-2.5 2.5V10"/>
            <path d="M12 10a2.5 2.5 0 0 1 2.5 2.5" />
            <path d="M12 20.5a8.5 8.5 0 1 1-8.5-8.5A8.5 8.5 0 0 1 12 20.5Z" />
            <path d="M12 12V6" />
          </svg>
          <h3>Sustentabilidade Ambiental</h3>
          <p class="value" id="environmentalSustainability">100%</p>
          <p>Reduza a sua pegada de carbono e contribua para um futuro mais sustentável.</p>
        </div>
      </div>
    </section>
  
    <!-- Seção de Payback -->
    <section class="container payback-section-bg">
      <h2>O seu investimento se paga em poucos anos.</h2>
      <p class="lead" style="color: #d1d9e2;">Veja em quanto tempo você terá o retorno do seu capital.</p>
      <div class="payback-content-container">
        <p class="payback-details">Com o sistema GDIS Solar, o retorno sobre o seu investimento está garantido. A economia gerada na sua conta de luz irá cobrir o custo total do projeto em apenas cerca de <strong id="paybackYears">0 anos</strong>.</p>
        <div class="payback-highlight-box">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="payback-icon">
            <path d="M22 10.5V12a10 10 0 1 1-5.98-9.06"/>
            <path d="M10 21.5a1.5 1.5 0 0 0 3 0v-5a1.5 1.5 0 0 0-3 0v5Z"/>
          </svg>
          <p>O seu retorno financeiro é de <strong id="roiValue">R$ 0,00</strong></p>
        </div>
      </div>
    </section>

    <!-- Seção de Produtos -->
    <section class="container clean-section">
        <h2>Produtos de Alta Qualidade</h2>
        <p class="lead">Trabalhamos apenas com os melhores produtos do mercado para garantir a máxima performance e durabilidade do seu sistema.</p>
        <div class="grid prod-grid">
            <!-- Cards de Produtos (serão preenchidos por JS) -->
        </div>
    </section>
  
    <!-- Rodapé -->
    <footer class="contact-footer">
        <div class="contact-info">
            <a href="tel:+5581999999999" class="contact-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-phone"><path d="M22 16.92v3a2 2 0 0 1-2.18 2h-1.63a1.5 1.5 0 0 1-1.5-1.5A10.87 10.87 0 0 1 7.15 7.15A1.5 1.5 0 0 1 5.65 5.65H4a2 2 0 0 1-2-2.18a1.5 1.5 0 0 1-1.5-1.5A10.87 10.87 0 0 1 7.15 7.15A1.5 1.5 0 0 1 5.65 5.65H4a2 2 0 0 1-2-2.18L.7 2.18a2 2 0 0 1 2-2.18z"></path></svg>
                (81) 9999-9999
            </a>
            <a href="mailto:contato@gdis.com.br" class="contact-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
                contato@gdis.com.br
            </a>
            <a href="https://www.gdis.com.br" target="_blank" class="contact-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-globe"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10a15.3 15.3 0 0 1-4 10a15.3 15.3 0 0 1-4-10a15.3 15.3 0 0 1 4-10z"></path></svg>
                www.gdis.com.br
            </a>
        </div>
        <small>© 2024 GDIS Solar. Todos os direitos reservados.</small>
    </footer>

  <script>
    /**
     * Objeto de mapeamento para traduzir tipos de produtos da API para nomes amigáveis.
     */
    const productTypeMapping = {
      'inverter': 'Inversor',
      'inversor': 'Inversor',
      'modulo': 'Módulo',
      'structure': 'Estrutura'
    };
  
    /**
     * Mapeamento de temas para cores e outras variáveis.
     */
    const themes = {
      'alta_performance': {
        navBarClass: '',
        activeOptionClass: 'high-performance-active',
        bodyClass: ''
      },
      'economico': {
        navBarClass: '', // Adicione a classe específica se necessário
        activeOptionClass: 'economic-active',
        bodyClass: 'economic-theme'
      }
    };
  
    /**
     * Manipuladores de Elementos DOM
     */
    const formContainer = document.getElementById('formContainer');
    const proposalContainer = document.getElementById('proposalContainer');
    const searchForm = document.getElementById('searchForm');
    const projectIdInput = document.getElementById('projectIdInput');
    const messageBox = document.getElementById('messageBox');
    const navBar = document.querySelector('.nav-bar');
    const navBarOptions = document.querySelectorAll('.proposal-options .option');
  
    /**
     * Event Listener para o formulário de busca
     */
    searchForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const projectId = projectIdInput.value.trim();
      
      // Exibe uma mensagem de carregamento e esconde a mensagem de erro anterior
      showMessage('Carregando...', false);
      
      // Validação básica do projectId
      if (projectId.length < 1) {
          showMessage('Por favor, digite um ID de projeto válido.', true, 'error');
          return;
      }
  
      try {
        const proposta = await consultarPropostaPorId(projectId);
        if (proposta) {
          renderProposta(proposta);
        } else {
          showMessage('Proposta não encontrada. Verifique o ID do projeto.', true, 'error');
        }
      } catch (err) {
        console.error("Erro no fluxo da proposta:", err);
        showMessage(err.message, true, 'error');
      }
    });
  
    /**
     * Event Listener para os botões de opção na barra de navegação
     */
    navBarOptions.forEach(option => {
      option.addEventListener('click', (e) => {
        // Remove a classe 'selected' e a classe de tema de todas as opções
        navBarOptions.forEach(opt => {
          opt.classList.remove('selected', themes['alta_performance'].activeOptionClass, themes['economico'].activeOptionClass);
        });
  
        // Adiciona a classe 'selected' e a classe de tema à opção clicada
        const theme = e.currentTarget.dataset.theme;
        e.currentTarget.classList.add('selected', themes[theme].activeOptionClass);
  
        // Alterna a classe no body para mudar o tema
        document.body.className = themes[theme].bodyClass;
      });
    });
  
    /**
     * Exibe uma mensagem na caixa de mensagem.
     * @param {string} text - O texto da mensagem.
     * @param {boolean} isError - Se a mensagem é de erro (muda a cor).
     * @param {string} type - Tipo de mensagem: 'error' ou 'success'
     */
    function showMessage(text, isError, type = 'default') {
      messageBox.textContent = text;
      messageBox.style.display = 'block';
      if (type === 'error') {
          messageBox.style.backgroundColor = 'rgba(255, 0, 0, 0.2)';
          messageBox.style.borderColor = 'rgba(255, 0, 0, 0.4)';
      } else if (type === 'success') {
          messageBox.style.backgroundColor = 'rgba(0, 128, 0, 0.2)';
          messageBox.style.borderColor = 'rgba(0, 128, 0, 0.4)';
      } else {
          messageBox.style.backgroundColor = 'rgba(255, 255, 255, 0.2)';
          messageBox.style.borderColor = 'rgba(255, 255, 255, 0.4)';
      }
    }
  
    /**
     * Renderiza a proposta na página, preenchendo todos os campos dinâmicos.
     * @param {Object} proposta - O objeto da proposta retornado pela API.
     */
    function renderProposta(proposta) {
      // Oculta o formulário e exibe a proposta
      formContainer.style.display = 'none';
      proposalContainer.style.display = 'block';
  
      // Atualiza os elementos com os dados da proposta
      const clientName = document.getElementById('clientName');
      const proposalNumber = document.getElementById('proposalNumber');
      const systemPower = document.getElementById('systemPower');
      const monthlyGeneration = document.getElementById('monthlyGeneration');
      const monthlySavings = document.getElementById('monthlySavings');
      const propertyValueIncrease = document.getElementById('propertyValueIncrease');
      const paybackYears = document.getElementById('paybackYears');
      const roiValue = document.getElementById('roiValue');
      const navBarAvistaPrice = document.getElementById('navBarAvistaPrice');
      const navBarMinParcel = document.getElementById('navBarMinParcel');
      
      const prodGrid = document.querySelector('.prod-grid');
      prodGrid.innerHTML = ''; // Limpa os cards de produtos existentes
  
      // Preenche os dados principais
      clientName.textContent = proposta.nome_cliente || 'Cliente não identificado';
      proposalNumber.textContent = `#${proposta.id_proposta || '0000'}`;
      systemPower.textContent = `${(proposta.potencia_sistema || 0).toFixed(2)} kWp`;
      monthlyGeneration.textContent = `${(proposta.geracao_mensal || 0).toFixed(2)} kWh`;
      monthlySavings.textContent = (proposta.economia_mensal || 0).toLocaleString("pt-BR", { minimumFractionDigits: 2, style: 'currency', currency: 'BRL' });
      propertyValueIncrease.textContent = `${(proposta.valor_imovel_aumento || 0).toFixed(0)}%`;
      paybackYears.textContent = `${proposta.payback_anos || 4} anos`;
      roiValue.textContent = (proposta.retorno_investimento || 0).toLocaleString("pt-BR", { minimumFractionDigits: 2, style: 'currency', currency: 'BRL' });
      navBarAvistaPrice.textContent = (proposta.valor_total || 0).toLocaleString("pt-BR", { minimumFractionDigits: 2, style: 'currency', currency: 'BRL' });
      navBarMinParcel.textContent = (proposta.valor_parcela || 0).toLocaleString("pt-BR", { minimumFractionDigits: 2, style: 'currency', currency: 'BRL' });
      
      // Renderiza os produtos
      if (proposta.produtos && proposta.produtos.length > 0) {
        proposta.produtos.forEach(prod => {
          const prodCard = document.createElement('div');
          prodCard.classList.add('card', 'prod-card');
          prodCard.innerHTML = `
            <h3>${prod.nome || 'Produto'}</h3>
            <img src="${prod.imagem_url || 'https://placehold.co/300x200'}" alt="Imagem do produto ${prod.nome || ''}" class="prod-image">
            <div class="prod-table">
              <div>Tipo</div>
              <div>${productTypeMapping[prod.tipo] || prod.tipo || 'N/A'}</div>
              <div>Marca</div>
              <div>${prod.marca || 'N/A'}</div>
              <div>Modelo</div>
              <div>${prod.modelo || 'N/A'}</div>
              <div>Quantidade</div>
              <div>${prod.quantidade || 'N/A'}</div>
            </div>
          `;
          prodGrid.appendChild(prodCard);
        });
      }
  
      // Exibe a nav bar fixa quando a proposta é carregada
      navBar.classList.add('show-prices');
  
      // Adiciona uma classe ao body para o tema 'alta_performance' por padrão
      document.body.className = themes['alta_performance'].bodyClass;
      
      // Seleciona a opção de alta performance
      document.querySelector('.high-performance-option').classList.add('selected');
    }

    /**
     * Consulta a proposta ativa de um cliente chamando o backend.
     * @param {string} projectId - O ID do projeto.
     * @returns {Promise<Object|null>} Um objeto com a proposta ou null em caso de falha.
     */
    async function consultarPropostaPorId(projectId) {
        // A URL agora usa o ID do projeto, conforme a documentação
        const backendUrl = `https://gdissolarproposta.vercel.app/api/proposta?projectId=${projectId}`;
        
        try {
            const res = await fetch(backendUrl);
            
            if (!res.ok) {
                let errorMessage = `Erro HTTP: ${res.status}`;
                try {
                    const errorBody = await res.json();
                    if (errorBody && errorBody.error) {
                        errorMessage = `Erro: ${errorBody.error}`;
                    } else if (errorBody && errorBody.message) {
                        errorMessage = `Erro: ${errorBody.message}`;
                    }
                } catch (e) {
                    // Se não for um JSON válido, a mensagem genérica será mantida
                }
                throw new Error(errorMessage);
            }
            
            const dados = await res.json();
            return dados;
        } catch (err) {
            console.error("Erro ao consultar proposta:", err);
            throw err;
        }
    }
  </script>

</body>
</html>
